"""
–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞ "–õ–∏—á–Ω—ã–π –¢–∞—Ä–æ–ª–æ–≥ ‚ú®üîÆ‚ú®"
"""
import sys
from src.config import load_config
from src.bot import run_bot


def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
    
    –í—ã–ø–æ–ª–Ω—è–µ—Ç:
    - –ó–∞–≥—Ä—É–∑–∫—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    - –ü—Ä–æ–≤–µ—Ä–∫—É –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
    - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    - –û–±—Ä–∞–±–æ—Ç–∫—É graceful shutdown
    """
    try:
        print("üåü –ó–∞–ø—É—Å–∫ –õ–∏—á–Ω–æ–≥–æ –¢–∞—Ä–æ–ª–æ–≥–∞...")
        print("=" * 50)
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        print("üîß –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é...")
        config = load_config()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
        token = config.get('telegram_bot_token', '').strip()
        if not token:
            print("‚ùå –û—à–∏–±–∫–∞: –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ config.json")
            print("üí° –î–æ–±–∞–≤—å—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –æ—Ç @BotFather –≤ –ø–æ–ª–µ 'telegram_bot_token'")
            sys.exit(1)
        
        # –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ
        bot_username = config.get('bot_username', '–ù–µ —É–∫–∞–∑–∞–Ω')
        model_name = config.get('model_name', '–ù–µ —É–∫–∞–∑–∞–Ω')
        
        print(f"ü§ñ Bot: {bot_username}")
        print(f"üß† Model: {model_name}")
        print("=" * 50)
        print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω. –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.")
        print("=" * 50)
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
        run_bot(config)
        
    except KeyboardInterrupt:
        print("\n" + "=" * 50)
        print("üõë –ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (Ctrl+C)...")
        print("üëã –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        print("=" * 50)
        sys.exit(0)
    except Exception as e:
        print(f"\n‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ: {e}")
        print("üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞")
        sys.exit(1)


if __name__ == "__main__":
    main()